<div class= "container">
  <div class= "row">
    <h2 class= "p-4 text-secondary font-weight-bold">作品詳細情報</h2>
  </div>
  <div class= "row">
    <div class= "col-7">
      <div class= "">
        <h6 class= "font-weight-bold">作品名</h6>
        <%= @post.title %>
      </div>
      <div class= "mt-4">
        <h6 class= "font-weight-bold">ジャンル</h6>
        <%= @post.genre.genre_name %>
      </div>
      <div class= "mt-4">
        <% if @post.image.attached? %>
          <%= image_tag @post.image, size: "500x400" %>
        <% else %>
          <img src= "/assets/noimage.png" width="500" height="400" >
        <% end %>
      </div>
      <div class= "mt-4">
        <h6 class= "font-weight-bold">作品説明</h6>
        <%= @post.description %>
      </div>
      <div class= "mt-4">
        <% if @post.user == current_user %>
          <%= link_to "Edit", edit_post_path(@post), class: "btn btn-success" %>
        <% end %>
      </div>
      <div class= "mt-4">
        <% if @post.favorited_by?(current_user) %>
          <%= link_to post_favorites_path(@post),method: :delete do %>
            <h3 class= "text-danger">♥</h3>
          <% end %>
          <%= @post.favorites.count %>いいね
        <% else %>
          <%= link_to post_favorites_path(@post),method: :post do %>
            <h3 class= "text-muted">♡</h3>
          <% end %>
          <%= @post.favorites.count %>いいね
        <% end %>
      </div>
      <div class= "mt-3">
        <%= form_with(model:[@post,@comment],loacal: true) do |f| %>
        <%= f.text_area :comment, size: "50x5", placeholder: "コメントをここに入力" %>
        <%= f.submit "Comment", class: "btn btn-primary ml-4 mb-4"  %>
        <% end %>
      </div>
    </div>
    <div class= "col-5 border mb-4">
      <div class= "pt-3">
        <h6 class= "font-weight-bold text-center">コメント件数</h6>
        <p class= "text-center"><%= @post.comments.count %>件</p>
      </div>
      <div class= "overflow-auto">
          <% @post.comments.each do |comment| %>
          <div class= "border-bottom mt-2">
            <div class= "d-flex bd-highlight">
            <div>
              <% if @post.user.image.attached? %>
              <%= image_tag @post.user.image, size: "60x60", class: "rounded-circle" %>
              <% else %>
              <img src= "/assets/no_image_profile.jpg", width= "60", height= "60", class= "rounded-circle">
              <% end %>
            </div>
            <div class= "flex-fill bd-highlight ml-4 mr-1">
              <%= comment.comment %>
            </div>
            <div>
              <% if comment.user == current_user %>
                <%= link_to "Delete",post_comment_path(comment.post,comment), method: :delete, class: "btn btn-danger" %>
              <% end %>
            </div>
            </div>
            <div>
              <p class= "text-right">Commented by <%= link_to comment.user.name, user_path(@post.user) %></p>
            </div>
          </div>
         <% end %>
      </div>
    </div>
  </div>
</div>